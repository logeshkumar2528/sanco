@using scfs_erp.Models;
@{
    Layout = "~/Views/Shared/_LayOut.cshtml";
    ViewBag.Title = "Line No Updation";
}

<div id="main-content">
    <div class="col-md-12">
        <div class="row">
            <div class="col-md-12">
                <div class="box">
                    <div class="box-header">
                        <div class="box-name">
                            <i class="glyphicon glyphicon-import"></i>
                            <strong>Line No Updation</strong>
                        </div>
                    </div>@Html.Raw(ViewBag.msg)
                    <div class="box-content" data-ng-app="myModule">
                        <form action="@Url.Content("~/ImportUpdateDetails/update")" method="post" accept-charset="utf-8" id="frm" data-ng-controller="myController" name="frm" onsubmit="return Validate()">
                            @Html.ValidationSummary(true)
                            <fieldset id="ExportCartingOrder_info">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="col-md-3">

                                            <div class="form-group">
                                                <label>IGM No </label>
                                                <input type="text" class="OSMIGMNO form-control" name="OSMIGMNO" id="OSMIGMNO" placeholder="Enter IGM No" tabindex="6" />
                                            </div>
                                        </div>
                                        <div class="col-md-3">

                                            <div class="form-group">
                                                <label>Line No </label>
                                                <input type="text" class="OSMLNO form-control" name="OSMLNO" id="OSMLNO" placeholder="Enter LINE No" tabindex="7" />

                                            </div>
                                        </div>
                                        <div class="col-md-2">

                                            <div class="form-group">
                                                <br />
                                                <input type="button" name="search" value="Search" class="btn btn-success btn-xs  " id="search" onclick="GetDetail()" tabindex="8" />
                                            </div>
                                        </div>



                                    </div>

                                    <input type="text" id="pd_index" value="0" style="display:none">

                                    <div style="float:right">
                                    </div>
                                    <div style="clear:both"> </div>
                                </div>

                                <div class="panel-heading navbar-inverse" style="color:white"> Details</div>

                                <table class="table table-striped table-bordered bootstrap-datatable TDETAIL" id="TDETAIL">
                                    <thead>
                                        <tr>

                                            <th>S No</th>
                                            <th>
                                                In Date
                                            </th>
                                            <th>
                                                Container No
                                            </th>
                                            <th>
                                                Size
                                            </th>

                                            <th>
                                                IGM NO

                                            </th>
                                            <th>
                                                LNO
                                            </th>
                                            <th>Steamer</th>
                                            <th><input type='checkbox' id='CHCK_ALL' name='CHCK_ALL' class='CHCK_ALL hide' onchange="checkall()" /></th>

                                        </tr>
                                    </thead>

                                    <tbody id="job_list"></tbody>
                                </table>



                                <br />
                                <div class="col-lg-12">
                                    <div class="col-lg-4">

                                        <div class="form-group">
                                            <label>New Line No</label>
                                            <input type="text" class="form-control" name="N_LINENO" id="N_LINENO" />
                                        </div>
                                    </div>

                                </div>


                                <div class="col-md-12 box-footer">
                                    <input type="button" name="back" value="Go Back" class="btn btn-primary btn-xs  pull-left" onclick="JavaScript:history.back()" />

                                    <input type="submit" name="submit" value="Submit" class="btn btn-success btn-xs  " id="save" tabindex="5010" />

                                </div>

                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {

    <script type="text/javascript">
        function GetSelValues() {
            GTYPE = $(".GTYPE option:selected").val();
            if (GTYPE == 0) {
                $(".GREMRKS").val("Sec-48");
            }
            else {
                $(".GREMRKS").val("");
                //$(".GSTYPE").empty();
                //$(".GSTYPE").append("<option value=0>YES</option><option value=1>NO</option>");
            }
        }



        $(document).ready(function () {
            GetSelValues();




        });//.......end of bind



        function total() {
            i = 0; //$("#TRANGAMT").val("0");
            // $(".TRANDID").each(function () {
            $(".STFDIDS").each(function () {
                ckb = $(this).is(':checked');

                if (ckb == true) {

                    $(".boolSTFDIDS")[i].value = ckb;
                    //   if ($(".boolSTFDIDS")[i].value == "true") { count++; }


                }
                else {


                    $(".boolSTFDIDS")[i].value = false;

                }

                i++;
            });

        }

        //........get detail row.....................//
        function GetDetail() {
            // alert("SS");

            var igmno = $("#OSMIGMNO").val();
            var gplno = $("#OSMLNO").val();

            if (igmno == "") {
                alert('Please Enter IGM No');
                $("#OSMIGMNO").focus();
                return false;
            }

            if (gplno == "") {
                alert('Please Enter Line No');
                $("#OSMLNO").focus();
                return false;
            }

            url = "/ImportUpdateDetails/Detail/" + igmno + "~" + gplno + "~";
            // alert(url);


            $.ajax({
                url: url,
                success: function (data) {
                    //alert(data);
                    $("#job_list").html("");
                    $("#job_list").html(data);

                }

            });//---End of Post--------

        }

        function Validate() {
            var flag = true;
            var i = 0;
            var tbl = $("#TDETAIL").find('tbody').length;

            var igmno = $("#OSMIGMNO").val();
            var gplno = $("#OSMLNO").val();

            if (igmno == "") {
                alert('Please Enter IGM No');
                $("#OSMIGMNO").focus();
                //return false;
                flag = false;
            }
            else if (gplno == "") {
                alert('Please Enter Line No');
                $("#OSMLNO").focus();
                //return false;
                flag = false;
            }
            else if ((tbl > 0) && ($('input[type=checkbox]:checked').length == 0)) {
                alert("ERROR! Please select at least one checkbox");
                flag = false;

            }
            else if ($('#N_LINENO').val() == "") {
                alert("Please Enter  New Line No");
                $('#N_LINENO').focus();
                flag = false;
            }
            if (flag) {

                var r = confirm("Are you sure to submit this record ?");
                if (r == true) {
                    return true;
                } else {

                    return false;

                }
            } else {

                return false;
            }

        }

        function checkall() {
            i = 0; j = 0;
            CHCK_ALL = $("#CHCK_ALL").is(':checked');
            var tbl = $("#TDETAIL").find('tbody');


            $(".STFDIDS").each(function () {

                $trcur = tbl.find("tr:eq(" + i + ")");
                if (CHCK_ALL == true) {
                    $trcur.find(".STFDIDS").prop("checked", true);
                    $(".boolSTFDIDS")[i].value = "true"; //alert("i" + i);
                }
                else {
                    // alert("i..."+i);
                    $trcur.find(".STFDIDS").removeAttr("checked", true);
                    $(".boolSTFDIDS")[i].value = "false";
                }

                i++;

            });



        }/*.....*/
        function Validate() {
            if ($("#N_LINENO").val() == "") {
                alert("Please Enter Line Number.."); return false;
            }

            var conf_txt = confirm("Are you sure to update?");
            if (conf_txt == true) {
                return true;
            }
            else
                return false;
        }
    </script>
}